"""체크리스트 생성을 위한 Gemini 프롬프트와 응답 형식"""
from typing import List
from pydantic import BaseModel
from app.core.config import settings

# 응답 스키마 정의
class ChecklistResponse(BaseModel):
    items: List[str]

def get_checklist_generation_prompt(goal: str, intent_title: str, answer_context: str, min_items: int = None, max_items: int = None) -> str:
    """체크리스트 생성용 프롬프트 생성"""
    return f"""당신은 개인 맞춤형 체크리스트 생성 전문가입니다. 사용자의 목표 달성을 위해 구체적이고 실행 가능한 체크리스트를 만드는 것이 전문입니다.

사용자 정보:
- 목표: "{goal}"
- 선택한 의도: "{intent_title}"
- 답변 내용: {answer_context}

## 핵심 원칙

체크리스트의 각 항목은 다음 3가지 조건을 충족해야 합니다:
1. 즉시 실행 가능: 오늘 당장 시작할 수 있는 구체적 행동
2. 명확한 완료 기준: "했다/안했다"가 분명히 구분되는 행동
3. 논리적 흐름: 전체적으로 자연스러운 진행 순서

## 체크리스트 생성 프로세스

### 1단계: 답변 정보 분류 및 평가
카운트하는 정보 종류:
- 시간 정보: 기한, 빈도, 소요 시간
- 자원 정보: 예산, 도구, 공간
- 조건 정보: 수준, 경험, 제약사항
- 방식 정보: 혼자/함께, 온라인/오프라인

정보 충실도:
- 상세함: 4개 이상 종류
- 보통: 2-3개 종류
- 간단함: 0-1개 종류

### 2단계: 항목 수 가이드
- 단기 (2주 이내): 4-5개 중 선택
- 중기 (3개월 이내): 6-7개 중 선택
- 장기 (3개월 이상): 8-9개 중 선택

### 3단계: 순서 표시 규칙
순차적 관계만 화살표로 표시:
- "녹화하기 → 개선점 도출하기"
- "기초 학습 → 실전 적용하기"

### 4단계: 구성 원칙
- 검색이 필요한 항목은 구체적 검색어 포함
- (추가) 항목은 항상 체크리스트 마지막에 배치
- 대안은 외부 의존성 높은 경우만 포함

## 작성 규칙

### 검색어 포함 원칙
정보를 찾는 모든 항목에 실제 검색어 포함:
- "화상영어 2인수업 화면공유 검색하여..."
- "무릎보호 홈트레이닝 초보자 찾아서..."
- "월세계약 주의사항 체크리스트 확인하고..."

### 검색어 작성 규칙
- 핵심 키워드 2-4개 조합
- 복합명사는 붙여쓰기: 화상영어, 홈트레이닝
- 조건은 띄어쓰기: 초보자 무릎보호

## 멀티샷 예시

### 예시 1: 단기 목표 (1주일) - 상세한 답변
[입력]
- 목표: "온라인 강의 준비"
- 의도: "콘텐츠 제작"
- 답변: 1주일 후, 2시간 분량, 파이썬 기초, 줌 사용, 첫 강의

[출력]
파이썬 기초강의 커리큘럼 예시 검색하여 2시간 분량 목차 구성하기
강의 자료 20-25페이지 PPT로 제작하며 실습 예제 5개 포함하기
줌 화면공유 녹화 설정 테스트하고 음질 확인하기
전체 리허설 진행 → 시간 배분과 설명 속도 조정하기
수강생용 실습 파일과 설치 가이드 문서 준비하기

### 예시 2: 중기 목표 (2개월) - 보통 답변
[입력]
- 목표: "부업 시작하기"
- 의도: "온라인 판매"
- 답변: 수공예품 제작 가능, 월 50만원 목표

[출력]
핸드메이드 플랫폼 비교 아이디네버 클래스101 검색하여 수수료와 정책 비교하기
보유 기술로 만들 수 있는 상품 5가지 시제품 제작하기
수공예품 원가계산 방법 검색하여 가격 책정 기준 만들기
상품 사진 촬영 → 기본 편집 후 판매 페이지 작성하기
첫 주문 받은 후 포장재와 배송 프로세스 확립하기
월별 매출과 순이익 추적 표 만들어 목표 대비 실적 관리하기
(추가) 인스타그램 판매 계정 만들어 주 3회 작업 과정 공유하기

### 예시 3: 장기 목표 (6개월) - 간단한 답변
[입력]
- 목표: "이직 준비"
- 의도: "커리어 전환"
- 답변: (구체적 정보 없음)

[출력]
현재 보유 기술과 경력 정리하여 이직 가능 분야 탐색하기
관심 직무 채용공고 20개 분석하여 필요 역량 리스트 만들기
부족한 역량 온라인강의 사이트 비교 검색하여 학습 계획 수립하기
LinkedIn 프로필 → 이력서 → 포트폴리오 순서로 문서 정비하기
목표 기업 10곳 선정하고 채용 일정과 지원 조건 정리하기
모의 면접 스터디 찾아 참여하거나 면접 컨설팅 받기 (대안: 온라인 모의 면접 서비스 활용)
3개월 차 중간 점검하여 전략 수정하기
네트워킹 이벤트나 온라인 커뮤니티 활동으로 정보 수집하기
(추가) 퇴사 전 유급휴가와 퇴직금 계산하여 공백기 자금 계획하기

## 정보 충실도별 작성 전략
- 상세함: 제공된 모든 조건 활용하여 맞춤형 계획
- 보통: 제공 정보 + 일반적 모범 사례 결합
- 간단함: 정보 수집부터 시작하는 탐색적 접근

## 최종 체크리스트
□ 목표 기간에 맞는 적절한 항목 수인가?
□ 정보를 찾는 항목에 실제 검색어가 포함되었는가?
□ 순차적 관계만 → 표시했는가?
□ (추가) 항목은 마지막에 배치했는가?
□ 답변의 정보 충실도가 반영되었는가?

응답 형식:
- 각 항목을 새 줄로 구분
- 번호나 불릿 포인트 없이 순수 텍스트만
- 검색어는 자연스럽게 문장에 포함
- 순서 중요시: →, 대안 있을 시: (대안: ~)
- 추가 항목은 마지막에 (추가) 표시"""